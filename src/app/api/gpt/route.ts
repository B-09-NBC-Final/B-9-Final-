import OpenAI from "openai";

export const GET = async () => {
    console.log(">>callGPT");
    const openai = new OpenAI({
        apiKey: process.env.NEXT_PUBLIC_OPENAI_SECRET_KEY,
    });
    const response = await openai.chat.completions.create({
        model: "gpt-4o-mini",
        messages: [
            {
                "role": "system",
                "content": [
                    {
                        "type": "text",
                        "text": "나는 업계 1위 식단 영양사이다. 출생년도, 성별, 키(cm), 체중(kg), 식단목적( 체중감량, 체중 증량, 체중유지, 저염식, 저당식), 평균 수면시간과 같이 사용자의 입력을 고려하여 일주일치의 7개식단을 짜고 그에 따른 운동을 추천해줄 것이다. \n식단 형식은 아래와 똑같이 출력 할 것 이다.\n###아침 메뉴: \n탄수화물, 단백질, 지방 비율: \\n\n칼로리: \\n\\n\n###점심 메뉴: \n\\n탄수화물, 단백질, 지방 비율: \n\\n칼로리:\\n\\n\n###저녁 메뉴:\n\\n탄수화물, 단백질, 지방 비율:\\n\n칼로리:\\n\\n총 칼로리:\\n\\n\n\n###추천운동\\n\n운동종류:\\n\n운동방법:\\n\n운동 팁:\\n\n운동 횟수 및 시간:\n\\n운동의 영향:\n\\n주의사항:\n\n아래와 같이 질의응답이 별도의 부연설명이 없이 실행되도록 해줘.\n---\nQ: 2000년생, 남자,170cm, 65kg, 체중증량을 목적, 평균수면시간(6시간)\nA: 월요일\n### 아침 메뉴:\n- 스크램블 에그 (계란 3개) + 아보카도 반 개\n- 토스트 2장 (통밀)\n- 플레인 그릭 요거트 한 컵 + 꿀 한 스푼\n- 바나나 1개\n\n탄수화물, 단백질, 지방 비율: 50% 탄수화물, 30% 단백질, 20% 지방\n칼로리: 약 700 kcal\n\n### 점심 메뉴:\n- 닭가슴살 스테이크 (200g) + 믹스드 그린 샐러드 (채소들, 올리브 오일 드레싱)\n- 퀴노아 한 컵 또는 현미밥 반 공기\n- 구운 고구마 한 개\n\n탄수화물, 단백질, 지방 비율: 45% 탄수화물, 35% 단백질, 20% 지방\n칼로리: 약 800 kcal\n\n### 저녁 메뉴:\n- 연어 스테이크 (150g) + 구운 채소들 (브로콜리, 당근 등)\n- 퀴노아 한 컵 또는 현미밥 반 공기\n- 견과류 한 줌 (아몬드, 호두)\n\n탄수화물, 단백질, 지방 비율: 40% 탄수화물, 35% 단백질, 25% 지방\n칼로리: 약 750 kcal\n\n총 칼로리: 약 2250 kcal\n\n### 추천운동\n운동종류: 근력 운동\n운동방법: 풀 바디 운동\n운동 팁: 큰 근육군을 중심으로 운동을 진행하여 체중 증량과 근육 증가를 효과적으로 도모하세요.\n운동 횟수 및 시간: 주 4-5회, 매회 60-75분\n운동의 영향: 근육량 증가와 신진대사율 향상\n주의사항: 충분한 스트레칭을 통해 부상을 예방하고, 운동 전후로 충분한 수분을 섭취하세요.\n\n운동 프로그램 예제:\n1. 바벨 스쿼트 (4세트 x 8-12회)\n2. 데드리프트 (4세트 x 8-12회)\n3. 벤치 프레스 (4세트 x 8-12회)\n4. 턱걸이 또는 풀업 (3세트 x 최대 반복)\n5. 밀리터리 프레스 (3세트 x 8-12회)\n6. 런지 (3세트 x 12회 각 다리)\n7. 플랭크 (3세트 x 1분)\n\n화요일\n### 아침 메뉴:\n- 스크램블 에그 (계란 3개) + 아보카도 반 개\n- 토스트 2장 (통밀)\n- 플레인 그릭 요거트 한 컵 + 꿀 한 스푼\n- 바나나 1개\n\n탄수화물, 단백질, 지방 비율: 50% 탄수화물, 30% 단백질, 20% 지방\n칼로리: 약 700 kcal\n\n### 점심 메뉴:\n- 닭가슴살 스테이크 (200g) + 믹스드 그린 샐러드 (채소들, 올리브 오일 드레싱)\n- 퀴노아 한 컵 또는 현미밥 반 공기\n- 구운 고구마 한 개\n\n탄수화물, 단백질, 지방 비율: 45% 탄수화물, 35% 단백질, 20% 지방\n칼로리: 약 800 kcal\n\n### 저녁 메뉴:\n- 연어 스테이크 (150g) + 구운 채소들 (브로콜리, 당근 등)\n- 퀴노아 한 컵 또는 현미밥 반 공기\n- 견과류 한 줌 (아몬드, 호두)\n\n탄수화물, 단백질, 지방 비율: 40% 탄수화물, 35% 단백질, 25% 지방\n칼로리: 약 750 kcal\n\n총 칼로리: 약 2250 kcal\n\n### 추천운동\n운동종류: 근력 운동\n운동방법: 풀 바디 운동\n운동 팁: 큰 근육군을 중심으로 운동을 진행하여 체중 증량과 근육 증가를 효과적으로 도모하세요.\n운동 횟수 및 시간: 주 4-5회, 매회 60-75분\n운동의 영향: 근육량 증가와 신진대사율 향상\n주의사항: 충분한 스트레칭을 통해 부상을 예방하고, 운동 전후로 충분한 수분을 섭취하세요.\n\n운동 프로그램 예제:\n1. 바벨 스쿼트 (4세트 x 8-12회)\n2. 데드리프트 (4세트 x 8-12회)\n3. 벤치 프레스 (4세트 x 8-12회)\n4. 턱걸이 또는 풀업 (3세트 x 최대 반복)\n5. 밀리터리 프레스 (3세트 x 8-12회)\n6. 런지 (3세트 x 12회 각 다리)\n7. 플랭크 (3세트 x 1분)\n\n---"
                    }
                ]
            },
            {
                "role": "user",
                "content": [
                    {
                        "type": "text",
                        "text": "나는 2000년생, 남자, 170cm, 65kg의 스펙을 가지고 체중증량을 목적으로 평균수면시간(6시간)을 고려하여 진단을 받고 싶습니다"
                    }
                ]
            },
            // 아래는 gpt 결과 예시입니다.
            //   {
            //     "role": "assistant",
            //     "content": [
            //       {
            //         "type": "text",
            //         "text": "오케이. 체중감량을 목표로 하고 있으며, 고혈압과 수면부족(6시간)의 연관성을 고려하여 일주일 식단과 운동 계획을 짜도록 하겠습니다. 고혈압 관리와 체중감량을 동시에 목표로 하기 위해 저염식 식단을 포함하도록 하겠습니다.\n\n### 월요일\n\n**아침 메뉴:**  \n오트밀 1컵 (190g) + 블루베리 (1/2컵), 무지방 우유 (1컵)  \n**탄수화물, 단백질, 지방 비율:** 60% / 25% / 15%  \n**칼로리:** 300\n\n**점심 메뉴:**  \n구운 치킨 샐러드 (치킨 가슴살 150g, 다양한 채소, 올리브 오일 1큰술), 혼합 견과류 (30g)  \n**탄수화물, 단백질, 지방 비율:** 40% / 45% / 15%  \n**칼로리:** 450\n\n**저녁 메뉴:**  \n현미밥 (1/2 공기), 구운 연어 (100g), 찐 브로콜리 (1컵), 작은 토마토 샐러드  \n**탄수화물, 단백질, 지방 비율:** 55% / 30% / 15%  \n**칼로리:** 400\n\n**총 칼로리:** 1150\n\n**추천운동**  \n**운동종류:** 빠르게 걷기 또는 저강도 달리기  \n**운동 횟수 및 시간:** 하루 40분  \n**운동의 영향:** 심혈관 건강 개선, 칼로리 소모, 고혈압 관리  \n**주의사항:** 수분을 충분히 섭취하고 운동 전후 스트레칭을 충분히 해주세요.\n\n### 화요일\n\n**아침 메뉴:**  \n그릭 요거트 (1컵) + 아몬드 (10개) + 꿀 (1티스푼)  \n**탄수화물, 단백질, 지방 비율:** 45% / 40% / 15%  \n**칼로리:** 350\n\n**점심 메뉴:**  \n현미밥 (1공기), 두부구이 (150g), 신선한 샐러드 (상추, 오이, 당근)  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 450\n\n**저녁 메뉴:**  \n미역국 (무염), 고등어 구이 (100g), 찐 야채 (콩나물, 시금치)  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 400\n\n**총 칼로리:** 1200\n\n**추천운동**  \n**운동종류:** 요가  \n**운동 횟수 및 시간:** 하루 30분  \n**운동의 영향:** 유연성 향상, 스트레스 감소, 혈압 조절  \n**주의사항:** 스트레칭을 충분히 하고, 무리하지 마세요.\n\n### 수요일\n\n**아침 메뉴:**  \n통밀 토스트 (2장) + 삶은 달걀 (2개), 오렌지 주스 (1컵)  \n**탄수화물, 단백질, 지방 비율:** 55% / 30% / 15%  \n**칼로리:** 300\n\n**점심 메뉴:**  \n렌틸콩 수프 (1컵), 현미밥 (1/2공기), 신선한 채소 샐러드  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 450\n\n**저녁 메뉴:**  \n찹스테이크 (저염), 구운 야채 (브로콜리, 당근)  \n**탄수화물, 단백질, 지방 비율:** 45% / 40% / 15%  \n**칼로리:** 400\n\n**총 칼로리:** 1150\n\n**추천운동**  \n**운동종류:** 고정형 자전거  \n**운동 횟수 및 시간:** 하루 40분  \n**운동의 영향:** 심혈관 건강 개선, 칼로리 소모  \n**주의사항:** 올바른 자세를 유지해주세요. 물을 충분히 마셔주세요.\n\n### 목요일\n\n**아침 메뉴:**  \n파인애플 (1컵), 무지방 요구르트 (1컵)  \n**탄수화물, 단백질, 지방 비율:** 60% / 30% / 10%  \n**칼로리:** 350\n\n**점심 메뉴:**  \n현미밥 (1/2 공기), 닭가슴살 (구운 것, 150g), 찐 야채 (전자레인지 사용 가능)  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 450\n\n**저녁 메뉴:**  \n병아리콩 샐러드 (병아리콩 100g, 사과, 샐러리, 양파, 올리브 오일 1큰술)  \n**탄수화물, 단백질, 지방 비율:** 55% / 30% / 15%  \n**칼로리:** 450\n\n**총 칼로리:** 1250\n\n**추천운동**  \n**운동종류:** 플랭크와 코어 운동  \n**운동 횟수 및 시간:** 하루 20분  \n**운동의 영향:** 근력 강화, 체지방 감소  \n**주의사항:** 무리하지 않은 수준에서 시작하고 점차 강도를 올려줍니다.\n\n### 금요일\n\n**아침 메뉴:**  \n그린 스무디 (시금치, 바나나 1개, 아몬드 밀크 1컵)  \n**탄수화물, 단백질, 지방 비율:** 55% / 35% / 10%  \n**칼로리:** 300\n\n**점심 메뉴:**  \n곤약밥, 닭가슴살 샐러드  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 450\n\n**저녁 메뉴:**  \n도미 구이(100g), 구운 감자(1개), 혼합 샐러드  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 450\n\n**총 칼로리:** 1200\n\n**추천운동**  \n**운동종류:** HIIT (고강도 인터벌 트레이닝)  \n**운동 횟수 및 시간:** 20분  \n**운동의 영향:** 칼로리 소모, 심혈관 기능 강화  \n**주의사항:** 충분히 경로성 운동을 해줍니다. 무리하지 않고 자신에 맞는 강도로 합니다.\n\n### 토요일\n\n**아침 메뉴:**  \n계란 오믈렛 (계란 2개, 채소 다진 것)  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 300\n\n**점심 메뉴:**  \n통밀 파스타 샐러드 (통밀 파스타 80g, 구운 채소, 올리브 오일 1큰술)  \n**탄수화물, 단백질, 지방 비율:** 55% / 30% / 15%  \n**칼로리:** 450\n\n**저녁 메뉴:**  \n두부 스테이크, 현미밥, 생야채  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 450\n\n**총 칼로리:** 1200\n\n**추천운동**  \n**운동종류:** 줌바 또는 에어로빅  \n**운동 횟수 및 시간:** 40분  \n**운동의 영향:** 칼로리 소모, 스트레스 해소  \n**주의사항:** 무리하지 말고 자신의 페이스에 맞게 운동합니다.\n\n### 일요일\n\n**아침 메뉴:**  \n바나나 팬케이크 (바나나 1개, 계란 2개)  \n**탄수화물, 단백질, 지방 비율:** 55% / 35% / 10%  \n**칼로리:** 300 \n\n**점심 메뉴:**  \n스윗포테이토와 닭가슴살  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 450\n\n**저녁 메뉴:**  \n고구마, 구운 야채, 연어 샐러드  \n**탄수화물, 단백질, 지방 비율:** 50% / 35% / 15%  \n**칼로리:** 450\n\n**총 칼로리:** 1200\n\n**추천운동**  \n**운동종류:** 하체 중심 운동 (스쿼트, 런지 등)  \n**운동 횟수 및 시간:** 30분  \n**운동의 영향:** 근력 강화, 체지방 감소  \n**주의사항:** 무리하지 말고 자신의 능력에 맞게 수행해주세요.\n\n이 식단과 운동 계획을 따르시면 고혈압 관리와 체중 감량 목표 달성에 도움이 될 것입니다. 또한, 수면시간을 더욱 확보하기 위해 노력해보는 것도 좋겠습니다. 잠은 신체 회복과 체중 감량에 중요한 역할을 합니다."
            //       }
            //     ]
            //   },
        ],
        temperature: 1,
        max_tokens: 13084,
        top_p: 1,
        frequency_penalty: 0,
        presence_penalty: 0,
    });

    console.log("result", response.choices[0].message.content);

    return Response.json({ data: response.choices[0].message.content });
};
